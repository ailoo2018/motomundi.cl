(function (t, e) {
    if ("function" == typeof define && define.amd)
        define(["module", "exports", "angular"], e);
    else if ("undefined" != typeof exports)
        e(module, exports, require("angular"));
    else {
        var n = {
            exports: {}
        };
        e(n, n.exports, t.angular),
            t.infiniteScroll = n.exports
    }
})

(this, function (t, e, n) {
    "use strict";

    function i(t) {
        return t && t.__esModule ? t : {
            "default": t
        }
    }

    Object.defineProperty(e, "__esModule", {
        value: !0
    });
    var r = i(n)
        , o = "infinite-scroll";
    r["default"].module(o, []).value("THROTTLE_MILLISECONDS", null).directive("infiniteScroll", ["$rootScope", "$window", "$interval", "THROTTLE_MILLISECONDS", function (t, e, n, i) {
        return {
            scope: {
                infiniteScroll: "&",
                infiniteScrollContainer: "=",
                infiniteScrollDistance: "=",
                infiniteScrollDisabled: "=",
                infiniteScrollUseDocumentBottom: "=",
                infiniteScrollListenForEvent: "@"
            },
            link: function (o, a, s) {
                function l(t) {
                    var e = t[0] || t;
                    return isNaN(e.offsetHeight) ? e.document.documentElement.clientHeight : e.offsetHeight
                }

                function u(t) {
                    var e = t[0] || t;
                    return isNaN(window.pageYOffset) ? e.document.documentElement.scrollTop : e.ownerDocument.defaultView.pageYOffset
                }

                function c(t) {
                    if (t[0].getBoundingClientRect && !t.css("none"))
                        return t[0].getBoundingClientRect().top + u(t)
                }

                function f() {
                    var e = void 0
                        , i = void 0;
                    if (k === w)
                        e = l(k) + u(k[0].document.documentElement),
                            i = c(a) + l(a);
                    else {
                        e = l(k);
                        var r = 0;
                        void 0 !== c(k) && (r = c(k)),
                            i = c(a) - r + l(a)
                    }
                    _ && (i = l((a[0].ownerDocument || a[0].document).documentElement));
                    var s = i - e
                        , f = s <= l(k) * b + 1;
                    f ? (C = !0,
                    x && (o.$$phase || t.$$phase ? o.infiniteScroll() : o.$apply(o.infiniteScroll))) : (T && n.cancel(T),
                        C = !1)
                }

                function d(t, e) {
                    function i() {
                        return a = (new Date).getTime(),
                            n.cancel(o),
                            o = null,
                            t.call()
                    }

                    function r() {
                        var r = (new Date).getTime()
                            , s = e - (r - a);
                        s <= 0 ? (n.cancel(o),
                            o = null,
                            a = r,
                            t.call()) : o || (o = n(i, s, 1))
                    }

                    var o = null
                        , a = 0;
                    return r
                }

                function h() {
                    k.unbind("scroll", A),
                    null != E && (E(),
                        E = null),
                    T && n.cancel(T)
                }

                function p(t) {
                    b = parseFloat(t) || 0
                }

                function m(t) {
                    x = !t,
                    x && C && (C = !1,
                        A())
                }

                function g(t) {
                    _ = t
                }

                function v(t) {
                    null != k && k.unbind("scroll", A),
                        k = t,
                    null != t && k.bind("scroll", A)
                }

                function y(t) {
                    if (null != t && 0 !== t.length) {
                        var e = void 0;
                        if (e = t.nodeType && 1 === t.nodeType ? r["default"].element(t) : "function" == typeof t.append ? r["default"].element(t[t.length - 1]) : "string" == typeof t ? r["default"].element(document.querySelector(t)) : t,
                            null == e)
                            throw new Error("invalid infinite-scroll-container attribute.");
                        v(e)
                    }
                }

                function $() {
                    return S && A(),
                        n.cancel(T)
                }

                var w = r["default"].element(e)
                    , b = null
                    , x = null
                    , C = null
                    , k = null
                    , S = !0
                    , _ = !1
                    , E = null
                    , T = !1
                    , A = null != i ? d(f, i) : f;
                return o.$on("$destroy", h),
                    o.$watch("infiniteScrollDistance", p),
                    p(o.infiniteScrollDistance),
                    o.$watch("infiniteScrollDisabled", m),
                    m(o.infiniteScrollDisabled),
                    o.$watch("infiniteScrollUseDocumentBottom", g),
                    g(o.infiniteScrollUseDocumentBottom),
                    v(w),
                o.infiniteScrollListenForEvent && (E = t.$on(o.infiniteScrollListenForEvent, A)),
                    o.$watch("infiniteScrollContainer", y),
                    y(o.infiniteScrollContainer || []),
                null != s.infiniteScrollParent && v(r["default"].element(a.parent())),
                null != s.infiniteScrollImmediateCheck && (S = o.$eval(s.infiniteScrollImmediateCheck)),
                    T = n($)
            }
        }
    }
    ]),
        e["default"] = o,
        t.exports = e["default"]
});